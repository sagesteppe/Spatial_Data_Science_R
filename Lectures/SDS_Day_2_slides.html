<!DOCTYPE html>
<html lang="en"><head>
<script src="SDS_Day_2_slides_files/libs/clipboard/clipboard.min.js"></script>
<script src="SDS_Day_2_slides_files/libs/quarto-html/tabby.min.js"></script>
<script src="SDS_Day_2_slides_files/libs/quarto-html/popper.min.js"></script>
<script src="SDS_Day_2_slides_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="SDS_Day_2_slides_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="SDS_Day_2_slides_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="SDS_Day_2_slides_files/libs/quarto-html/quarto-syntax-highlighting-dark-474c6d7e63be50eb6972897072b39b27.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.36">

  <meta name="author" content="Reed Benkendorf">
  <meta name="dcterms.date" content="2022-02-11">
  <title>R Data Science: Spatial Data Science II</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="SDS_Day_2_slides_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="SDS_Day_2_slides_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; background-color: #2a0f15; font-weight: bold; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
  </style>
  <link rel="stylesheet" href="SDS_Day_2_slides_files/libs/revealjs/dist/theme/quarto-5b48f34d633aed70c74c672477009ffc.css">
  <link rel="stylesheet" href="custom.css">
  <link href="SDS_Day_2_slides_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="SDS_Day_2_slides_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="SDS_Day_2_slides_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="SDS_Day_2_slides_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="SDS_Day_2_slides_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="SDS_Day_2_slides_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="SDS_Day_2_slides_files/libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="SDS_Day_2_slides_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
  <style>
  #title-slide .title {
    font-size: 1.5em;
  }
  #image tags .center {
    text-align: center;
    font-size: 4em;
    font-color: cbc4c3;
  }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">R Data Science: Spatial Data Science II</h1>
  <p class="subtitle">R for Data Science</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Reed Benkendorf 
</div>
</div>
</div>

  <p class="date">February 11, 2022</p>
</section>
<section id="section" class="slide level2" data-background-image="../pictures/Pioneer_Mtns_ID.jpg">
<h2></h2>
<p>Assigned Reading: Chapter 3 of Spatial Data Science</p>
</section>
<section>
<section id="topology" class="title-slide slide level1 center">
<h1>Topology</h1>
<p>Many/Most geographic operations are geometric in nature</p>
</section>
<section id="theoretical-relations-i" class="slide level2">
<h2>Theoretical Relations I</h2>
<div style="float: left; width: 50%;">
<ul>
<li>Dimensionally Extended 9-Intersection Model (DE-9IM)</li>
<li>Developed to query spatial databases</li>
<li>Serves as the standard for describing relations</li>
</ul>
</div>
<div style="float: right; width: 50%; font-size: 0.8em; color: #cbc4c3; text-align: center;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../pictures/DE-9IM_By_Krauss.png" style="width:85.0%;height:50.0%"></p>
<figcaption>DE-9IM (Krauss)</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="theoretical-relations-ii" class="slide level2">
<h2>Theoretical Relations II</h2>
<div style="float: left; width: 50%;">
<p><font size="5"></font></p><font size="5">
<p>Upper Middle Panel, dimensions containing the intersection of the <strong>Interior</strong> of ‘A’ to the <strong>Boundary</strong> of ‘B’ is equal to a line.</p>
<p><span class="math display">\[
dim[I(a)∩B(b)] = 1
\]</span></p>
<p>where ‘I’ is the ‘Interior’ (of ‘A’) &amp; ‘B’ is the ‘Boundary’ (of ‘B’)</p>
<p><span class="math display">\[
\text{∩ is the 'Intersection'}
\]</span></p>
</font><p><font size="5">‘1’ denotes that the product of the intersection is a line - it’s the maximal dimension when intersecting to a boundary! </font></p>
</div>
<div style="float: right; width: 50%; font-size: 0.8em; color: #cbc4c3; text-align: center;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../pictures/DE-9IM_By_Krauss.png" style="width:85.0%;height:50.0%"></p>
<figcaption>DE-9IM (Krauss)</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="applications" class="slide level2">
<h2>Applications</h2>
<div style="float: left; width: 60%;">
<p><font size="5"> A schema for describing spatial relationships<br>
</font></p>
<p><font size="4"></font></p><font size="4">
<p><span class="math inline">\(dim[I(a)∩I(b)] = 2\)</span> Which areas are in both polygons<br>
<span class="math inline">\(dim[I(a)∩B(b)] = 1\)</span> Which areas are in ‘a’, and the boundary of ‘b’<br>
<span class="math inline">\(dim[I(a)∩E(b)] = 2\)</span> Which areas are in ‘a’, but not in ‘b’</p>
<p><span class="math inline">\(dim[B(a)∩I(b)] = 1\)</span> Which areas are at the boundary of ‘a’, and in ‘b’<br>
<span class="math inline">\(dim[B(a)∩B(b)] = 0\)</span> Which areas are at the boundaries of ‘a’ and ‘b’<br>
<span class="math inline">\(dim[B(a)∩E(b)] = 1\)</span> Which areas are at the boundary of ‘a’, and outside ‘b’</p>
<p><span class="math inline">\(dim[E(a)∩I(b)] = 2\)</span> Which areas are in ‘b’ but not in ‘a’<br>
<span class="math inline">\(dim[E(a)∩B(b)] = 1\)</span> Which areas are at the boundary of ‘b’ and outside ‘a’<br>
<span class="math inline">\(dim[E(a)∩E(b)] = 2\)</span> Which areas are outside both ‘a’ and ‘b’</p>
</font><p><font size="4"></font></p>
</div>
<div style="float: right; width: 40%; font-size: 0.8em; color: #cbc4c3; text-align: center;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../pictures/DE-9IM_By_Krauss.png" style="width:85.0%;height:50.0%"></p>
<figcaption>DE-9IM (Krauss)</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="geometric-operations-on-spatial-predicates" class="title-slide slide level1 center">
<h1>Geometric Operations on Spatial Predicates</h1>

</section>
<section id="theoretical-properties" class="slide level2">
<h2>Theoretical Properties</h2>
<div style="float: center; width: 100%; font-size: 0.6em; color: #cbc4c3; text-align: center;">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SDS_Day_2_slides_files/figure-revealjs/Plot%20Topology-1.png" style="width:50.0%"></p>
<figcaption>Spatial Predicates after Egenhofer and Herring (1990)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="width:55%;">
<p><font size="5"> <strong>Disjoint</strong> Neither ‘A’ nor ‘B’ touch at any position<br>
<strong>Touches</strong> The boundaries of ‘A’ and ‘B’ touch<br>
<strong>Overlaps</strong> Portions of the interior of feature ‘A’ overlap the interior of ‘B’<br>
</font></p>
</div><div class="column" style="width:45%;">
<p><font size="5"> <strong>Covers</strong> ‘A’ is encapsulated by ‘B’ several sides, but a boundary of ‘A’ shares a border with ‘B’<br>
<strong>Contains</strong> All borders of one feature are contained by another<br>
<strong>Equals</strong> ‘A’ and ‘B’ have identical extents.<br>
</font></p>
</div></div>
</section>
<section id="implementations" class="slide level2">
<h2>Implementations</h2>
<p>postGIS implements the following three tests in addition to those on the previous slide:</p>
<ul>
<li><strong>Intersects</strong> (includes: ‘st_touches’, ‘st_overlaps’, ‘st_covers’, ‘st_contain’, ‘st_equals’)<br>
</li>
<li><strong>Within</strong> (includes: ‘st_contains’)<br>
</li>
<li><strong>CoveredBy</strong> (includes: ‘st_equals’)</li>
</ul>
</section>
<section id="applications-1" class="slide level2">
<h2>Applications</h2>
<ul>
<li>Relationships can be tested using the sf package</li>
</ul>
<details>
<summary>
sf implementation
</summary>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>st_disjoint(A, B_disjoint, sparse = F): TRUE</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>st_touches(A, B_touches, sparse = F): TRUE</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>st_equals(A, B_overlap, sparse = F): TRUE</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>st_covers(A, B_covers, sparse = F): TRUE</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>st_contains(A, B_contains, sparse = F): TRUE</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>st_equals(A, B_equals, sparse = F): TRUE</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>st_equals(A, B_disjoint, sparse = F): FALSE</code></pre>
</div>
</div>
</details>
<details>
<summary>
postGIS implementation
</summary>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>st_intersects(A, B_touches, sparse = F): TRUE</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>st_intersects(A, B_overlap, sparse = F): TRUE</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>st_intersects(A, B_covers, sparse = F): TRUE</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>st_intersects(A, B_contains, sparse = F): TRUE</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>st_intersects(A, B_equals, sparse = F): TRUE</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>st_within(A, B_contains, sparse = F): FALSE</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>st_within(B_contains, A, sparse = F): TRUE</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>st_coveredby(A, B_equals, sparse = F): TRUE</code></pre>
</div>
</div>
</details>
</section>
<section id="spatial-join" class="slide level2">
<h2>Spatial Join</h2>
<p>Combine objects based on their spatial relations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a>nghbrhd_parks <span class="ot">&lt;-</span> <span class="fu">st_join</span>(</span>
<span id="cb16-2"><a href=""></a>  chi_neighb, chi_parks, </span>
<span id="cb16-3"><a href=""></a>  <span class="at">join =</span> st_intersects, </span>
<span id="cb16-4"><a href=""></a>  <span class="at">left =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href=""></a>  <span class="fu">count</span>(pri_neigh) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div style="float: center; width: 75%; font-size: 0.6em; color: #cbc4c3; text-align: center;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="SDS_Day_2_slides_files/figure-revealjs/Spatial%20Joins%202-1.png" style="height:10.0%" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="assorted-spatial-vector-operations" class="title-slide slide level1 center">
<h1>Assorted Spatial Vector Operations</h1>
<p>This is really a grab bag of what I and others seem to use most the often. We are going to focus on vector data.</p>
</section>
<section id="import-a-vector-file" class="slide level2">
<h2>Import a Vector file</h2>
<p>Many formats of vector files may be imported to R. Here we import a shapefile, but the process is the same for geopackages etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" data-code-line-numbers="4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href=""></a>fp <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">'..'</span>, <span class="st">'spatial_lecture_data'</span>, <span class="st">'Chicago_Neighborhoods'</span>)</span>
<span id="cb17-2"><a href=""></a>files <span class="ot">&lt;-</span> <span class="fu">file.path</span>(fp, <span class="fu">list.files</span>(fp, <span class="st">".shp"</span>))</span>
<span id="cb17-3"><a href=""></a></span>
<span id="cb17-4"><a href=""></a>chi_neighb <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(files)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="convert-to-and-from-sp-objects" class="slide level2">
<h2>Convert to and from sp objects</h2>
<p>Often needed to be done on the fly</p>
<p>convert <code>sp</code> -&gt; <code>sf</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href=""></a>us_states.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(us_states.sp)</span>
<span id="cb18-2"><a href=""></a><span class="fu">class</span>(us_states.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sf"         "data.frame"</code></pre>
</div>
</div>
<p>convert <code>sf</code> -&gt; <code>sf</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href=""></a>us_states.sp <span class="ot">&lt;-</span> <span class="fu">as</span>(us_states.sf, <span class="st">'Spatial'</span>)</span>
<span id="cb20-2"><a href=""></a><span class="fu">class</span>(us_states.sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SpatialPolygonsDataFrame"
attr(,"package")
[1] "sp"</code></pre>
</div>
</div>
</section>
<section id="make-tabular-point-data-spatial" class="slide level2">
<h2>Make tabular point data spatial</h2>
<p><code>coords</code> columns holding coordinates<br>
<code>crs</code> The CRS the data are currently<br>
<code>remove = F</code> Should the original coordinate holding columns be removed?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href=""></a>museums.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(</span>
<span id="cb22-2"><a href=""></a>  museums, </span>
<span id="cb22-3"><a href=""></a>  <span class="at">coords =</span> <span class="fu">c</span>(<span class="at">x =</span> <span class="st">'longitude'</span>, <span class="at">y =</span> <span class="st">'latitude'</span>), </span>
<span id="cb22-4"><a href=""></a>  <span class="at">crs =</span> <span class="dv">4326</span>, </span>
<span id="cb22-5"><a href=""></a>  <span class="at">remove =</span> F</span>
<span id="cb22-6"><a href=""></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><font size="5"></font></p><font size="5">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">attribute</th>
<th style="text-align: left;">latitude</th>
<th style="text-align: left;">longitude</th>
<th style="text-align: left;">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Field Museum</td>
<td style="text-align: left;">41.86666</td>
<td style="text-align: left;">-87.61643</td>
<td style="text-align: left;">POINT (-87.61643 41.86666)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Science and Industry</td>
<td style="text-align: left;">41.79006</td>
<td style="text-align: left;">-87.58227</td>
<td style="text-align: left;">POINT (-87.58227 41.79006)</td>
</tr>
</tbody>
</table>
</div>
</div>
</font><p><font size="5"></font></p>
</section>
<section id="st_transform" class="slide level2">
<h2><code>st_transform</code></h2>
<details>
<summary>
Check CRS
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a><span class="fu">st_crs</span>(museums.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:4326 
  wkt:
GEOGCRS["WGS 84",
    ENSEMBLE["World Geodetic System 1984 ensemble",
        MEMBER["World Geodetic System 1984 (Transit)"],
        MEMBER["World Geodetic System 1984 (G730)"],
        MEMBER["World Geodetic System 1984 (G873)"],
        MEMBER["World Geodetic System 1984 (G1150)"],
        MEMBER["World Geodetic System 1984 (G1674)"],
        MEMBER["World Geodetic System 1984 (G1762)"],
        MEMBER["World Geodetic System 1984 (G2139)"],
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]],
        ENSEMBLEACCURACY[2.0]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["geodetic latitude (Lat)",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["geodetic longitude (Lon)",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    USAGE[
        SCOPE["Horizontal component of 3D system."],
        AREA["World."],
        BBOX[-90,-180,90,180]],
    ID["EPSG",4326]]</code></pre>
</div>
</div>
</details>
<p>project coordinates from one CRS to another. EPSG codes are numeric and simple to use!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href=""></a>museums.conus_albers <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(museums.sf, <span class="at">crs =</span> <span class="dv">5070</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>verify the projection worked with <code>st_crs</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href=""></a><span class="fu">st_crs</span>(museums.conus_albers)[[<span class="st">'input'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "EPSG:5070"</code></pre>
</div>
</div>
</section>
<section id="remove-simple-feature-list-column" class="slide level2">
<h2>Remove simple feature list column</h2>
<p>Oftentimes required to feed a data set into other packages, the list columns can confuse them.</p>
<p><font size="5"></font></p><font size="5">
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href=""></a><span class="fu">head</span>(museums.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 2 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -87.61643 ymin: 41.79006 xmax: -87.58227 ymax: 41.86666
Geodetic CRS:  WGS 84
# A tibble: 2 × 4
  attribute            latitude longitude             geometry
  &lt;chr&gt;                &lt;chr&gt;    &lt;chr&gt;              &lt;POINT [°]&gt;
1 Field Museum         41.86666 -87.61643 (-87.61643 41.86666)
2 Science and Industry 41.79006 -87.58227 (-87.58227 41.79006)</code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href=""></a>museums <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(museums.sf) <span class="co"># method one, pipe-able </span></span>
<span id="cb30-2"><a href=""></a><span class="fu">st_geometry</span>(museums.sf) <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># method two, drop in place. </span></span>
<span id="cb30-3"><a href=""></a><span class="fu">head</span>(museums)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  attribute            latitude longitude
  &lt;chr&gt;                &lt;chr&gt;    &lt;chr&gt;    
1 Field Museum         41.86666 -87.61643
2 Science and Industry 41.79006 -87.58227</code></pre>
</div>
</div>
</font><p><font size="5"></font></p>
</section>
<section id="make-geometry-a-valid-simple-feature" class="slide level2">
<h2>Make geometry a valid Simple Feature</h2>
<p>Some spatial data may not be in a simple format sf package can <em>generally</em> fix this</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href=""></a><span class="fu">st_is_valid</span>(p1)</span>
<span id="cb32-2"><a href=""></a><span class="fu">st_is_valid</span>(p1, <span class="at">reason =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>st_is_valid(p1): FALSE</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>st_is_valid(p1, reason = TRUE): Self-intersection[5 5]</code></pre>
</div>
</div>
<p>making the geometry simple with st_make_valid()</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href=""></a>p2 <span class="ot">&lt;-</span> <span class="fu">st_make_valid</span>(p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="make-geometry-a-valid-simple-feature-1" class="slide level2">
<h2>Make geometry a valid Simple Feature</h2>
<p>Polygon became a multipolygon with two polygons<br>
Split by removal of self-intersection at position X5, Y5.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href=""></a><span class="fu">class</span>(p1)[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sfc_POLYGON"</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href=""></a><span class="fu">class</span>(p2)[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sfc_MULTIPOLYGON"</code></pre>
</div>
</div>
</div></div>

<img data-src="SDS_Day_2_slides_files/figure-revealjs/unnamed-chunk-5-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="summarize-geometries-with-group_by" class="slide level2">
<h2><code>summarize</code> geometries with <code>group_by</code></h2>
<p><code>dplyr</code> can be used to union geometries by group</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href=""></a>regions <span class="ot">&lt;-</span> us_states <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href=""></a>  <span class="fu">group_by</span>(REGION) <span class="sc">%&gt;%</span> </span>
<span id="cb40-3"><a href=""></a>  <span class="fu">summarize</span>(<span class="at">geometry =</span> <span class="fu">st_union</span>(geometry))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="SDS_Day_2_slides_files/figure-revealjs/Summarize%203-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<details>
<summary>
input data
</summary>
<p><font size="4"></font></p><font size="4">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">NAME</th>
<th style="text-align: left;">REGION</th>
<th style="text-align: left;">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">South</td>
<td style="text-align: left;">MULTIPOLYGON (((-88.20006 3…</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arizona</td>
<td style="text-align: left;">West</td>
<td style="text-align: left;">MULTIPOLYGON (((-114.7196 3…</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Colorado</td>
<td style="text-align: left;">West</td>
<td style="text-align: left;">MULTIPOLYGON (((-109.0501 4…</td>
</tr>
<tr class="even">
<td style="text-align: left;">Connecticut</td>
<td style="text-align: left;">Norteast</td>
<td style="text-align: left;">MULTIPOLYGON (((-73.48731 4…</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Florida</td>
<td style="text-align: left;">South</td>
<td style="text-align: left;">MULTIPOLYGON (((-81.81169 2…</td>
</tr>
<tr class="even">
<td style="text-align: left;">Georgia</td>
<td style="text-align: left;">South</td>
<td style="text-align: left;">MULTIPOLYGON (((-85.60516 3…</td>
</tr>
</tbody>
</table>
</div>
</div>
</font>
</details>
<details>
<summary>
results
</summary>
<p><font size="4"></font></p><font size="4">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">REGION</th>
<th style="text-align: left;">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Norteast</td>
<td style="text-align: left;">MULTIPOLYGON (((-70.8173 42…</td>
</tr>
<tr class="even">
<td style="text-align: left;">Midwest</td>
<td style="text-align: left;">MULTIPOLYGON (((-85.48703 4…</td>
</tr>
<tr class="odd">
<td style="text-align: left;">South</td>
<td style="text-align: left;">MULTIPOLYGON (((-81.44412 3…</td>
</tr>
<tr class="even">
<td style="text-align: left;">West</td>
<td style="text-align: left;">MULTIPOLYGON (((-118.4887 3…</td>
</tr>
</tbody>
</table>
</div>
</div>
</font>
</details>
</div></div>
</section></section>
<section>
<section id="area-calculations" class="title-slide slide level1 center">
<h1>Area Calculations</h1>
<p>calculate the area of a polygon</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href=""></a><span class="fu">st_area</span>(chi_neighb)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] <span class="co"># restrict to 5 neighborhoods </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Units: [m^2]
[1]  4498293.6   200563.5  3016684.2   972375.8 11596322.7</code></pre>
</div>
</div>
<p>Data returned in m<sub>^2</sub> regardless of the CRS. However, different projected CRS will give different results</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>integer(0)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>81852.82 [m^2]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>42261063 [m^2]</code></pre>
</div>

<div class="cell-output cell-output-stdout">
<pre><code>integer(0)</code></pre>
</div>
</div>
<img data-src="SDS_Day_2_slides_files/figure-revealjs/Area%203-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:50.0%"></section>
<section id="area-calculations-accuracy" class="slide level2">
<h2>Area Calculations Accuracy</h2>
<p>When we use the ‘which’ logical test, we see that all areas in the results from both sets of area calculations are different. When we plot the values we see that both sets have nearly perfect correlation.</p>
<p>But neither of these values are as accurate as they could be. We want to use an Equal Area projected coordinate system instead.</p>
<p>Here we use the NAD83 Conus Albers, a favorite of the United States Geological Survey (USGS).</p>
</section>
<section id="area-calculcations-conversion" class="slide level2">
<h2>Area Calculcations conversion</h2>
<p>Values by converted by looking up constants, or by using the <code>units</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href=""></a><span class="fu">units</span>(equal_areas_proj) <span class="ot">&lt;-</span> units<span class="sc">::</span><span class="fu">make_units</span>(km<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb48-2"><a href=""></a><span class="fu">head</span>(equal_areas_proj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Units: [km^2]
[1] 0.08197562 0.15334617 0.20086333 0.25781909 0.31268312 0.32418268</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-striped caption-top" data-quarto-postprocess="true" style="font-size: 12px; width: auto !important; ">
<caption>Size of the Largest and Smallest Neighborhoods in Chicago</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Smallest
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Largest
</div></th>
</tr>
<tr class="even">
<th style="text-align: right;" data-quarto-table-cell-role="th">Neighborhood</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Area (m^2)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Neighborhood</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Area (m^2)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Magnificent Mile</td>
<td style="text-align: right;">81975.62</td>
<td style="text-align: right;">O'Hare</td>
<td style="text-align: right;">34545331</td>
</tr>
<tr class="even">
<td style="text-align: right;">Greektown</td>
<td style="text-align: right;">153346.17</td>
<td style="text-align: right;">South Deering</td>
<td style="text-align: right;">28222393</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Printers Row</td>
<td style="text-align: right;">200863.33</td>
<td style="text-align: right;">Englewood</td>
<td style="text-align: right;">16127634</td>
</tr>
<tr class="even">
<td style="text-align: right;">Millenium Park</td>
<td style="text-align: right;">257819.09</td>
<td style="text-align: right;">Austin</td>
<td style="text-align: right;">15796966</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Boystown</td>
<td style="text-align: right;">312683.12</td>
<td style="text-align: right;">Hegewisch</td>
<td style="text-align: right;">13559955</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="st_length-of-linestring" class="slide level2">
<h2><code>st_length</code> of linestring</h2>
<ul>
<li>Calculate the length of a linestring</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href=""></a><span class="fu">st_length</span>(NU_campuses)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>18578.52 [m]</code></pre>
</div>
</div>
</section>
<section id="boundary-calculations" class="slide level2">
<h2>Boundary calculations</h2>
<ul>
<li>‘convert’ the exterior of a polygon to a linestring (more on this later…)</li>
<li>calculate exterior using <code>st_length</code></li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>10370.89 [m]</code></pre>
</div>
</div>
</section></section>
<section id="centroids-point-on-surface" class="title-slide slide level1 center">
<h1>Centroids &amp; Point on Surface</h1>
<div style="float: left; width: 25%;">
<ul>
<li>Centroid the “geometric center of mass of a geometry” of an object.<br>
</li>
<li>If the centroid would fall outside of the polygons interior, use <code>st_point_on_surface</code> to constrain it</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href=""></a>chi_cent <span class="ot">&lt;-</span> <span class="fu">st_centroid</span>(chi_neighb)</span>
<span id="cb53-2"><a href=""></a>chi_pos <span class="ot">&lt;-</span> <span class="fu">st_point_on_surface</span>(chi_neighb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SDS_Day_2_slides_files/figure-revealjs/Centroid%20and%20POS%20Plot-1.png" class="quarto-figure quarto-figure-center" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div style="float: right; width: 75%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="SDS_Day_2_slides_files/figure-revealjs/Neighborhood%20Centroids-1.png" style="width:50.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="SDS_Day_2_slides_files/figure-revealjs/Neighborhood%20Centroids-2.png" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>

<section>
<section id="combine-union-features" class="title-slide slide level1 center">
<h1>Combine &amp; Union Features</h1>
<ul>
<li><em>Combine</em> will form a multipolygon
<ul>
<li>Retain all geometries as a multipolygon collection</li>
<li>Lose the attributes of each feature</li>
</ul></li>
<li><em>Union</em> will form a multipolygon
<ul>
<li>Retain only outer boundary geometries of features</li>
<li>Lose the attributes of each feature</li>
</ul></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SDS_Day_2_slides_files/figure-revealjs/Combine%20Plots-1.png" class="quarto-figure quarto-figure-center" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SDS_Day_2_slides_files/figure-revealjs/Union%20Plots-1.png" class="quarto-figure quarto-figure-center" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="st_cast" class="slide level2">
<h2><code>st_cast</code></h2>
<ul>
<li>Can be used to extract types of geometries from a multi(polygon, line, point)geometry, or geometry collection.</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="SDS_Day_2_slides_files/figure-revealjs/Cast%201-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Divide a Multipolygon into individual polygons.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SDS_Day_2_slides_files/figure-revealjs/Cast%203-1.png" class="quarto-figure quarto-figure-center" style="width:25.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top">
<caption>Original data</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Neighborhood</th>
<th style="text-align: left;">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Riverdale</td>
<td style="text-align: left;">MULTIPOLYGON (((-87.60157 4…</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sauganash,Forest Glen</td>
<td style="text-align: left;">MULTIPOLYGON (((-87.76919 4…</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Boystown</td>
<td style="text-align: left;">MULTIPOLYGON (((-87.64878 4…</td>
</tr>
<tr class="even">
<td style="text-align: left;">South Chicago</td>
<td style="text-align: left;">MULTIPOLYGON (((-87.54398 4…</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Galewood</td>
<td style="text-align: left;">MULTIPOLYGON (((-87.78523 4…</td>
</tr>
<tr class="even">
<td style="text-align: left;">Clearing</td>
<td style="text-align: left;">MULTIPOLYGON (((-87.73762 4…</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="caption-top">
<caption>Unioned Data</caption>
<thead>
<tr class="header">
<th style="text-align: left;">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MULTIPOLYGON (((-87.78527 4…</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="caption-top">
<caption>Data Cast to Polygons</caption>
<thead>
<tr class="header">
<th style="text-align: left;">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">POLYGON ((-87.78527 41.9164…</td>
</tr>
<tr class="even">
<td style="text-align: left;">POLYGON ((-87.64866 41.9399…</td>
</tr>
<tr class="odd">
<td style="text-align: left;">POLYGON ((-87.61417 41.8884…</td>
</tr>
<tr class="even">
<td style="text-align: left;">POLYGON ((-87.76919 42.0048…</td>
</tr>
<tr class="odd">
<td style="text-align: left;">POLYGON ((-87.66268 41.9543…</td>
</tr>
<tr class="even">
<td style="text-align: left;">POLYGON ((-87.71378 41.8043…</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section>
<section id="buffers-convex-hulls" class="title-slide slide level1 center">
<h1>Buffers &amp; Convex Hulls</h1>
<ul>
<li>Buffer: Enlarge a feature by a specified distance in X &amp; Y dimensions</li>
<li>Convex Hull: Encapsulate a feature in X &amp; Y dimensions.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SDS_Day_2_slides_files/figure-revealjs/Buffer%20and%20Convex%20Hull%202-1.png" style="width:75.0%"></p>
<figcaption>Buffer</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SDS_Day_2_slides_files/figure-revealjs/Buffer%20and%20Convex%20Hull%203-1.png" style="width:75.0%"></p>
<figcaption>Convex Hull of Chicago Neighborhoods, The City, and a buffer of 3km</figcaption>
</figure>
</div>
</div>
</div>
</section>

<section id="measuring-distances" class="title-slide slide level1 center">
<h1>Measuring Distances</h1>
<p>Theory: Remember the earth is a ellipsoid, distances must be calculated along the earths curved surface</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../pictures/Great_Circle_Distance_CheCheDaWaff.png" style="width:35.0%"></p>
<figcaption>Great Circle Distance (ChecCheDaWaff)</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li><em>P</em> Point of origin</li>
<li><em>Q</em> destination</li>
<li><em>u</em> &amp; <em>v</em> : antipodal points, positions across the ellipsoid from each other</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">Distance (Km)</th>
<th style="text-align: left;">Journey</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1144.3</td>
<td style="text-align: left;">American to Field</td>
</tr>
<tr class="even">
<td style="text-align: right;">334.7</td>
<td style="text-align: left;">American to Smithsonian</td>
</tr>
<tr class="odd">
<td style="text-align: right;">955.4</td>
<td style="text-align: left;">Field to Smithonian</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We can visualize this with some help from Charlie Joey Hadley whom some sf compliant great circle distance code</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SDS_Day_2_slides_files/figure-revealjs/Create%20Plot%20of%20Great%20Circle%20Distances-1.png" class="quarto-figure quarto-figure-center" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SDS_Day_2_slides_files/figure-revealjs/A%20dense%20distance%20matrix%20B-1.png" class="quarto-figure quarto-figure-center" style="width:75.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<table class="caption-top">
<caption>The five most Central Chicago Neighborhoods</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Neighborhood</th>
<th style="text-align: right;">Distance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Little Italy, UIC</td>
<td style="text-align: right;">10291.97</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lower West Side</td>
<td style="text-align: right;">10350.90</td>
</tr>
<tr class="odd">
<td style="text-align: left;">West Loop</td>
<td style="text-align: right;">10426.27</td>
</tr>
<tr class="even">
<td style="text-align: left;">Greektown</td>
<td style="text-align: right;">10455.72</td>
</tr>
<tr class="odd">
<td style="text-align: left;">United Center</td>
<td style="text-align: right;">10498.78</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>

<section>
<section id="an-introduction-to-some-types-of-spatial-analyses" class="title-slide slide level1 center">
<h1>An introduction to some types of Spatial Analyses</h1>

</section>
<section id="voronoi-polygons" class="slide level2">
<h2>Voronoi Polygons</h2>
<ul>
<li>Find the areas which are closest to objects</li>
</ul>

<img data-src="SDS_Day_2_slides_files/figure-revealjs/Create%20Voronoi%20Polygons-1.png" width="960" class="r-stretch"></section>
<section id="identifying-distance-based-neighbors" class="slide level2">
<h2>Identifying Distance Based Neighbors</h2>
<ul>
<li>One can find neighboring objects via distance thresholds using the spdep package</li>
<li>these neighbors can be used in many types of linear regression for spatial analyses</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 81 
Number of nonzero links: 1780 
Percentage nonzero weights: 27.13001 
Average number of links: 21.97531 
2 regions with no links:
13, 43
3 disjoint connected subgraphs
Link number distribution:

 0  4  5  6  7  8  9 15 17 18 20 21 22 23 24 25 26 27 28 29 30 32 33 34 
 2  1  1  1  4  3  2  2  2  1  5  3  1  2  9 10  8  9  2  3  3  1  4  2 
1 least connected region:
81 with 4 links
2 most connected regions:
26 27 with 34 links</code></pre>
</div>

</div>
<img data-src="SDS_Day_2_slides_files/figure-revealjs/Distance%20Based%20Neighbors-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="kernel-density-estimation-of-a-point-pattern" class="slide level2">
<h2>Kernel Density Estimation of a Point Pattern</h2>
<ul>
<li>estimate the <em>intensity</em> in a sense, the density of a process in space</li>
<li>more widely used for building models than simply estimating densities via projections</li>
</ul>

<img data-src="SDS_Day_2_slides_files/figure-revealjs/Kernel%20Density%20of%20a%20Point%20Pattern%20Process-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="cluster-a-point-pattern" class="slide level2">
<h2>Cluster a Point Pattern</h2>
<ul>
<li><p><strong>D</strong>ensity-<strong>B</strong>ased <strong>S</strong>patial <strong>C</strong>lustering of <strong>A</strong>pplications with <strong>N</strong>oise (DBSCAN).</p></li>
<li><p>Classification algorithm for grouping objects in space</p></li>
<li><p>Developed in the mid 90’s, still used and highly cited!</p></li>
<li><p>Requires two terms</p>
<ul>
<li>minium points: the number of points required to form a cluster</li>
<li>eps: loosely related to distance for which neighbor searches can occur</li>
</ul></li>
<li><p>Ripley’s K</p>
<ul>
<li>Determine whether a point process is not randomly distributed</li>
<li>Points can be fit with models of distributions</li>
<li>segments of a models fit above the poisson curve have clustered distributions</li>
<li>a process which can be worth modeling.</li>
</ul></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SDS_Day_2_slides_files/figure-revealjs/Cluster%20Points%20in%20Space%20Ripleys%20K-1.png" class="quarto-figure quarto-figure-center" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SDS_Day_2_slides_files/figure-revealjs/Cluster%20Points%20in%20Space%20-%20DBSCAN-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SDS_Day_2_slides_files/figure-revealjs/Visualize%20Clusters%20and%20Distance%20based%20Neighbors-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</section></section>
<section id="wrapping-up-the-spatial-data-science-module" class="title-slide slide level1 center">
<h1>Wrapping up the Spatial Data Science Module:</h1>
<p><strong>Future Bonus SDS Office Hours</strong> Wednesday Night at 5:00 - 6:00 in F-413.</p>
<p><strong>Notes on this Lab</strong> My lecture notes are in the R script I used to generate all of the novel figures for this presentation. This script is much longer and more complex than Lecture 1’s script. Likewise this presentation is an .HTML file and can be launched from your computer (it was rendered directly from R using the script).</p>
</section>

<section>
<section id="works-cited" class="title-slide slide level1 center">
<h1>Works Cited</h1>
<p>https://cran.r-project.org/web/packages/gstat/vignettes/gstat.pdf Accessed 1.21.2021</p>
<p>Bivand, R. https://cran.r-project.org/web/packages/spdep/vignettes/nb_sf.html Accessed 1.17.2021</p>
<p>Clementini, Eliseo; Di Felice, Paolino; van Oosterom, Peter (1993). “A small set of formal topological relationships suitable for end-user interaction”. In Abel, David; Ooi, Beng Chin (eds.). Advances in Spatial Databases: Third International Symposium, SSD ’93 Singapore, June 23–25, 1993 Proceedings. Lecture Notes in Computer Science. 692/1993. Springer. pp.&nbsp;277–295. doi:10.1007/3-540-56869-7_16. ISBN 978-3-540-56869-8. Accessed 1.16.2021</p>
<p>Egenhofer, M.J.; Herring, J.R. (1990). “A Mathematical Framework for the Definition of Topological Relationships”</p>
<p>Ester, Martin; Kriegel, Hans-Peter; Sander, Jörg; Xu, Xiaowei (1996). Simoudis, Evangelos; Han, Jiawei; Fayyad, Usama M. (eds.). A density-based algorithm for discovering clusters in large spatial databases with noise. Proceedings of the Second International Conference on Knowledge Discovery and Data Mining (KDD-96). AAAI Press. pp.&nbsp;226–231. CiteSeerX 10.1.1.121.9220. ISBN 1-57735-004-9.</p>
<p>Hadley, C.J. https://www.findingyourway.io/blog/2018/02/28/2018-02-28_great-circles-with-sf-and-leaflet/ Accessed 1.16.2021</p>
<p>Gimond, M. https://mgimond.github.io/Spatial/point-pattern-analysis-in-r.html Accessed 1.22.2022</p>
<p>Moreno, M., Basille, M. https://r-spatial.org/r/2018/10/25/ggplot2-sf-2.html Accessed 1.22.2022</p>
<p>Dennett, A. https://rstudio-pubs-static.s3.amazonaws.com/126356_ef7961b3ac164cd080982bc743b9777e.html Accessed 1.21.2022</p>
</section>
<section id="packages-cited" class="slide level2">
<h2>Packages cited:</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
Hijmans R (2024). _raster: Geographic Data Analysis and Modeling_. R
package version 3.6-30, &lt;https://CRAN.R-project.org/package=raster&gt;.

[[2]]
Pebesma E, Bivand R (2005). "Classes and methods for spatial data in
R." _R News_, *5*(2), 9-13. &lt;https://CRAN.R-project.org/doc/Rnews/&gt;.

Bivand R, Pebesma E, Gomez-Rubio V (2013). _Applied spatial data
analysis with R, Second edition_. Springer, NY.
&lt;https://asdar-book.org/&gt;.

[[3]]
Pebesma E, Bivand R (2023). _Spatial Data Science: With applications in
R_. Chapman and Hall/CRC. doi:10.1201/9780429459016
&lt;https://doi.org/10.1201/9780429459016&gt;, &lt;https://r-spatial.org/book/&gt;.

Pebesma E (2018). "Simple Features for R: Standardized Support for
Spatial Vector Data." _The R Journal_, *10*(1), 439-446.
doi:10.32614/RJ-2018-009 &lt;https://doi.org/10.32614/RJ-2018-009&gt;,
&lt;https://doi.org/10.32614/RJ-2018-009&gt;.

[[4]]
Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R,
Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E,
Bache SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi
K, Vaughan D, Wilke C, Woo K, Yutani H (2019). "Welcome to the
tidyverse." _Journal of Open Source Software_, *4*(43), 1686.
doi:10.21105/joss.01686 &lt;https://doi.org/10.21105/joss.01686&gt;.

[[5]]
Hijmans R (2024). _terra: Spatial Data Analysis_. R package version
1.7-83, &lt;https://CRAN.R-project.org/package=terra&gt;.

[[6]]
Bivand R, Nowosad J, Lovelace R (2024). _spData: Datasets for Spatial
Analysis_. R package version 2.3.3,
&lt;https://CRAN.R-project.org/package=spData&gt;.

[[7]]
Bivand R, Wong D (2018). "Comparing implementations of global and local
indicators of spatial association." _TEST_, *27*(3), 716-748.
doi:10.1007/s11749-018-0599-x
&lt;https://doi.org/10.1007/s11749-018-0599-x&gt;.

Roger Bivand (2022). "R Packages for Analyzing Spatial Data: A
Comparative Case Study with Areal Data." _Geographical Analysis_,
*54*(3), 488-518. doi:10.1111/gean.12319
&lt;https://doi.org/10.1111/gean.12319&gt;.

Bivand R, Pebesma E, Gómez-Rubio V (2013). _Applied spatial data
analysis with R, Second edition_. Springer, NY.
&lt;https://asdar-book.org/&gt;.

Pebesma E, Bivand R (2023). _Spatial Data Science With Applications in
R_. Chapman &amp; Hall. &lt;https://r-spatial.org/book/&gt;.

[[8]]
Pebesma EJ (2004). "Multivariable geostatistics in S: the gstat
package." _Computers &amp; Geosciences_, *30*, 683-691.

Gräler B, Pebesma E, Heuvelink G (2016). "Spatio-Temporal Interpolation
using gstat." _The R Journal_, *8*, 204-218.
&lt;https://journal.r-project.org/archive/2016/RJ-2016-014/index.html&gt;.

[[9]]
Baddeley A, Rubak E, Turner R (2015). _Spatial Point Patterns:
Methodology and Applications with R_. Chapman and Hall/CRC Press,
London. ISBN 9781482210200,
&lt;https://www.routledge.com/Spatial-Point-Patterns-Methodology-and-Applications-with-R/Baddeley-Rubak-Turner/p/book/9781482210200/&gt;.

Baddeley A, Turner R, Mateu J, Bevan A (2013). "Hybrids of Gibbs Point
Process Models and Their Implementation." _Journal of Statistical
Software_, *55*(11), 1-43. doi:10.18637/jss.v055.i11
&lt;https://doi.org/10.18637/jss.v055.i11&gt;.

Baddeley A, Turner R (2005). "spatstat: An R Package for Analyzing
Spatial Point Patterns." _Journal of Statistical Software_, *12*(6),
1-42. doi:10.18637/jss.v012.i06
&lt;https://doi.org/10.18637/jss.v012.i06&gt;.

[[10]]
Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain (2021).
"fields: Tools for spatial data." R package version 16.3,
&lt;https://github.com/dnychka/fieldsRPackage&gt;.</code></pre>
</div>
</div>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../pictures/CBG_Logos/NegauneeInstitute_CBG-Logo-FlowerMark.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="SDS_Day_2_slides_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="SDS_Day_2_slides_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="SDS_Day_2_slides_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="SDS_Day_2_slides_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="SDS_Day_2_slides_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="SDS_Day_2_slides_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="SDS_Day_2_slides_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="SDS_Day_2_slides_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="SDS_Day_2_slides_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="SDS_Day_2_slides_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="SDS_Day_2_slides_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true,"boardmarkerWidth":5},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>